/*!
 * 本地存储框架kStorgae v1.0
 * 说明：本文件支持IE6-7，如果不需要支持IE6-7请使用kStorage.min.js
 *
 * 开发日期: 2013-11-5
 * 压缩工具：uglifyjs
 * 依赖:无
 * 全局变量：kStorage, kst;
 * 项目地址: https://github.com/kasslun/kStorage/
 * 详细说明: http://kasslun.github.io/kStorage/
 */
!function(t){"use strict"
    var e,r,o,n=0,a=Number.MAX_VALUE,i=function(){},s=t.kst=t.kStorage={VERSION:"1.0",type:"none",support:!0,use:null,info:i,destroy:i},f=t.localStorage,u="[object Storage]",c=t.document,g=t.JSON||{}
    n=Math.min(n,7),"object"==typeof f&&("function"==typeof f.toString&&(e=""+f),e!==u&&f.constructor&&(e=""+f.constructor)),e===u?s.type="storage":c.documentElement.addBehavior&&(s.type="userData"),r=s._tool={dA:n,mA:a,coreToString:Object.prototype.toString,storage:t.localStorage,initObj:function(t){return delete t._data,delete t._info,t.set=t.remove=t.clear=function(){return this},t.get=t.count=function(){},t},error:function(t){throw Error(t)},getStorageName:function(t){return"string"==typeof t&&/^\w+$/g.test(t)||this.error("storageId Must be made by letter, numbers and underline"),"cs_"+t+"_"},filterName:function(t){"string"!=typeof t&&this.error("arg 'name' must be a string")},getExpiresDate:function(t){var e=new Date
        return e.setTime(e.getTime()+864e5*t),e.toUTCString()},random:function(){return(""+Math.random()).substring(2,10)-0},fixMaxAge:function(t){var e=typeof t
        return"number"===e?(t=0>t?0:t,Math.min(parseInt(t,10),this.mA)):void 0},stringifyJSON:g.stringify,parseJSON:g.parse},s._publicMethods={set:function(t,e){var o,n,a,i,s
        if(r.updateData(this),n=this._data,"object"==typeof n){if(a=r.stringifyJSON,"[object Object]"===r.coreToString.call(t))for(o in t)t.hasOwnProperty(o)&&(i=t[o],void 0===i?void 0!==n[o]&&(s=!0,delete n[o]):(i=a(i),n[o]!==i&&(s=!0,n[o]=i)))
        else r.filterName(t),void 0===e?e!==n[t]&&(s=!0,delete n[t]):(e=a(e),e!==n[t]&&(s=!0,n[t]=e))
            s&&r.setData(this)}return this},get:function(t){var e,o
        return r.updateData(this),r.filterName(t),e=this._data,"object"==typeof e&&(o=e[t],void 0!==o)?r.parseJSON(o):void 0},count:function(){var t,e,o
        if(r.updateData(this),e=this._data,"object"==typeof e){o=0
            for(t in e)o++
            return o}},remove:function(t){var e
        return r.updateData(this),r.filterName(t),e=this._data,"object"==typeof e&&void 0!==e[t]&&(delete e[t],r.setData(this)),this},clear:function(){return r.updateData(this),"object"==typeof this._data&&(this._data={},r.setData(this)),this},setMaxAge:function(t){t=r.fixMaxAge(t),void 0!==t&&(r.updateData(this),this._info&&(this._info.a=t,r.setInfo(this)))},getMaxAge:function(){return r.updateData(this),this._info?this._info.a:void 0}},"none"!==s.type?(o=/cs_kStorage_=1/,o.test(c.cookie)||(c.cookie="cs_kStorage_=1;path=/",s._firstLoad=!0)):(s.support=!1,s.use=function(){return s._tool.initObj({})})}(window),function(t){"use strict"
    function e(t,e,o){var n=(new Date).getTime()
        this._storageName=t,o?(this._data={},this._info={d:n,a:void 0===e?r.dA:e},r.setData(this)):(this._data=r.getItem(t)||{},this._info=r.getItem(t+a),this._info.d=n,r.setInfo(this))}var r,o,n,a,i=t.kStorage
    "storage"===i.type&&(r=i._tool,o=r.storage,n={},a="i",i.use=function(t,o){var i,s=r.getStorageName(t)
        return n[s]?n[s]:(r.createCallBack&&r.createCallBack(t),(i=r.getItem(s+a))?(n[s]=new e(s,void 0,!1),n[s]):(n[s]=new e(s,r.fixMaxAge(o),!0),n[s]))},i.exists=function(t){return!!this.info(t)},i.info=function(t){var e=r.getStorageName(t),o=r.getItem(e+a)
        return o?o:null},i.destroy=function(t){var e=r.getStorageName(t),i=n[e]
        o.removeItem(e),o.removeItem(e+a),i&&(r.initObj(i),delete n[e])},e.prototype=i._publicMethods,r.setData=function(t){try{o.setItem(t._storageName,this.stringifyJSON(t._data))}catch(e){}t._info.s=this.random(),this.setInfo(t)},r.setInfo=function(t){o.setItem(t._storageName+a,this.stringifyJSON(t._info))},r.updateData=function(t){var e=t._storageName,o=t._info,n=r.getItem(e+a)
        n?o&&o.s===n.s||(t._data=r.getItem(e)||{},t._info=n):t._data=t._info=void 0},r.getItem=function(t){var e
        try{e=this.parseJSON(o.getItem(t))}catch(r){}return e})}(window),function(tool){"use strict"
    var f
    if("function"!=typeof tool.stringifyJSON){f=function(t){return 10>t?"0"+t:t},"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()})
        var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep,quote=function(t){return escapable.lastIndex=0,escapable.test(t)?'"'+t.replace(escapable,function(t){var e=meta[t]
            return"string"==typeof e?e:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+t+'"'},str=function(t,e){var r,o,n,a,i,s=gap,f=e[t]
            switch(f&&"object"==typeof f&&"function"==typeof f.toJSON&&(f=f.toJSON(t)),"function"==typeof rep&&(f=rep.call(e,t,f)),typeof f){case"string":return quote(f)
                case"number":return isFinite(f)?f+"":"null"
                case"boolean":case"null":return f+""
                case"object":if(!f)return"null"
                    if(gap+=indent,i=[],"[object Array]"===Object.prototype.toString.apply(f)){for(a=f.length,r=0;a>r;r+=1)i[r]=str(r,f)||"null"
                        return n=0===i.length?"[]":gap?"[\n"+gap+i.join(",\n"+gap)+"\n"+s+"]":"["+i.join(",")+"]",gap=s,n}if(rep&&"object"==typeof rep)for(a=rep.length,r=0;a>r;r+=1)"string"==typeof rep[r]&&(o=rep[r],n=str(o,f),n&&i.push(quote(o)+(gap?": ":":")+n))
                else for(o in f)Object.prototype.hasOwnProperty.call(f,o)&&(n=str(o,f),n&&i.push(quote(o)+(gap?": ":":")+n))
                    return n=0===i.length?"{}":gap?"{\n"+gap+i.join(",\n"+gap)+"\n"+s+"}":"{"+i.join(",")+"}",gap=s,n}}
        tool.stringifyJSON=function(t,e,r){var o
            if(gap="",indent="","number"==typeof r)for(o=0;r>o;o+=1)indent+=" "
            else"string"==typeof r&&(indent=r)
            if(rep=e,e&&"function"!=typeof e&&("object"!=typeof e||"number"!=typeof e.length))throw Error("JSON.stringify")
            return str("",{"":t})},tool.parseJSON=function(text,reviver){function walk(t,e){var r,o,n=t[e]
            if(n&&"object"==typeof n)for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(o=walk(n,r),void 0!==o?n[r]=o:delete n[r])
            return reviver.call(t,e,n)}var j
            return text+="",cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(t){return"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))?(j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j):(this.error("JSON.parse"),void 0)}}}(window.kStorage._tool),function(t){"use strict"
    function e(t,e,r,n){var a=(new Date).getTime(),i=o.dA,s=void 0===r?i:r
        this._storageName=e,this._instantial=t,n?(this._data={},this._info={d:a,a:s},o.setData(this)):(this._data=o.getItem(t,"data")||{},this._info=o.getItem(t,"info"),this._info.d=a,o.setInfo(this))}var r,o,n,a,i,s=t.document,f=t.kStorage
    "userData"===f.type&&(o=f._tool,n={},function(){var t,e
        t=s.getElementsByTagName("script"),e=s.createElement("iframe"),e.src=(t[t.length-1].getAttribute("src").match(/^(.*\/)[^\/]*\.js/)||["",""])[1]+"carrier.html",e.style.display="none",s.body?s.body.appendChild(e):s.appendChild(e),r=e.contentWindow.document}(),i=function(t){var e=r.createElement("div")
        return e.innerHTML=t,r.body?r.body.appendChild(e):r.appendChild(e),e.addBehavior("#default#userData"),e},a=i("null"),f.use=function(t,r){var a,s=o.getStorageName(t)
        return n[s]?n[s]:(o.createCallBack&&o.createCallBack(t),a=i(s),a.load(s),o.getItem(a,"info")?(n[s]=new e(a,s,void 0,!1),n[s]):(n[s]=new e(a,s,o.fixMaxAge(r),!0),n[s]))},f.exists=function(t){return!!this.info(t)},f.info=function(t){var e,r=o.getStorageName(t)
        return a.load(r),e=o.getItem(a,"info"),e?e:null},f.destroy=function(t){var e,r=o.getStorageName(t),i=n[r]
        i?(e=i._instantial,e.expires=o.getExpiresDate(-99),e.save(r),e.parentNode.removeChild(e),o.initObj(i),delete n[r]):(a.load(r),a.expires=o.getExpiresDate(-99),a.save(r))},e.prototype=f._publicMethods,o.setData=function(t){try{t._instantial.setAttribute("data",o.stringifyJSON(t._data).replace(/\\"/g,"").replace(/"/g,""))}catch(e){}t._info.s=this.random(),this.setInfo(t)},o.setInfo=function(t){var e=t._instantial,r=t._info
        try{e.setAttribute("info",o.stringifyJSON(r).replace(/\\"/g,"").replace(/"/g,"")),e.expires=o.getExpiresDate(r.a||1),e.save(t._storageName)}catch(n){}},o.updateData=function(t){var e,r=t._instantial,o=t._info
        r.load(t._storageName),e=this.getItem(r,"info"),e?o&&o.s===e.s||(t._info=e,t._data=this.getItem(r,"data")||{}):t._data=t._info=void 0},o.getItem=function(t,e){var r
        try{r=o.parseJSON(t.getAttribute(e).replace(/\u0081/g,'\\"').replace(/\u0080/g,'"'))}catch(n){}return r})}(window),function(t){"use strict"
    var e,r,o,n,a,i,s,f
    if(t.support){if(o=t._tool,e=t.use("_kStorageCookieManager",90),n=e._data,t._firstLoad){t.destroy("_kStorageSessionManager"),s=(new Date).getTime()
        for(a in n)i=o.parseJSON(n[a]),i&&i[1]&&i[1]<s&&delete n[a]
        o.setData(e)}r=t.use("_kStorageSessionManager",90),f=function(t){e.remove(t),r.remove(t)},t.cookie={set:function(t,n,a){var i,s
        return o.filterName(t),void 0===n?(f(t),this):void 0===a?(e.remove(t),r.set(t,n),this):(i=o.coreToString.call(a).slice(8,-1),s=(new Date).getTime(),"Number"===i?0>=a?f(t):(r.remove(t),e.set(t,[n,s+a])):"Date"===i?(a=a.getTime(),s>=a?f(t):(r.remove(t),e.set(t,[n,a]))):o.error("arg expires error"),this)},get:function(t){var n
        return o.filterName(t),n=e.get(t),n?n[1]&&n[1]<(new Date).getTime()?(e.remove(t),void 0):n[0]:r.get(t)},remove:function(t){return o.filterName(t),f(t),this}}}}(window.kStorage),function(t){"use strict"
    var e,r,o,n,a,i,s=t.kStorage
    if(s.support&&s._firstLoad)if(o=s.use("_kStorageCreateManager"),n=o.get("nameList"),e=(new Date).getTime(),"object"==typeof n){for(a in n)i=s.info(a),(!i||0===i.a||e>i.d+864e5*i.a)&&(s.destroy(a),delete n[a])
        o.set("nameList",n)}else if("storage"===s.type){r=t.localStorage
        for(a in r)a=/^cs_(\w{8,})_$/.exec(a),a&&(a=a[1],i=s.info(a),(!i||0===i.a||e>i.d+864e5*i.a)&&s.destroy(a))}}(window),function(t){"use strict"
    var e,r,o=t.kStorage
    o.support&&(e=o.use("_kStorageCreateManager",90),o._tool.createCallBack=function(t){r=e.get("nameList")||{},r[t]||(r[t]=1,e.set("nameList",r))})}(window)